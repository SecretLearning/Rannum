possible improvement:
- prepassword does not change until it is used.
